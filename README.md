Вроде, учел все требования ТЗ.
Ошибок не нашел.
Если что-то не так - могу допилить.
